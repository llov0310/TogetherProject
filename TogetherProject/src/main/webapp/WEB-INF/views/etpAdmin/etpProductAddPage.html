<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<th:block layout:fragment="page_css">
	<style>
#uploader {
	-webkit-appearance: none;
	appearance: none;
	width: 50%;
	margin-bottom: 10px;
}

.inputArea {
	margin: 10px 0;
}

select {
	width: 100px;
}

label {
	display: inline-block;
	width: 70px;
	padding: 5px;
}

label[for='gdsDes'] {
	display: block;
}

input {
	width: 150px;
}

textarea#gdsDes {
	width: 400px;
	height: 180px;
}

.filebox label {
	display: inline-block;
	padding: .5em .75em;
	color: #999;
	font-size: inherit;
	line-height: normal;
	vertical-align: middle;
	background-color: #fdfdfd;
	cursor: pointer;
	border: 1px solid #ebebeb;
	border-bottom-color: #e2e2e2;
	border-radius: .25em;
}

.filebox input[type="file"] { /* 파일 필드 숨기기 */
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	border: 0;
}

.filebox.bs3-primary label {
	color: #fff;
	background-color: #337ab7;
	border-color: #2e6da4;
}

#loading {
	width: 100%;
	height: 100%;
	top: 0px;
	left: 0px;
	position: fixed;
	display: block;
	opacity: 0.7;
	background-color: #fff;
	z-index: 99;
	text-align: center;
}

#loading-image {
	position: absolute;
	top: 42%;
	left: 42%;
	z-index: 100;
}
</style>
</th:block>

<th:block layout:fragment="page_js">
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<!-- 	<script src="/etpAdmin/vendor/jquery/jquery.min.js"></script> -->
	<script src="/etpAdmin/js/etpProductAddPage.js"></script>
</th:block>

<th:block layout:fragment="contents" scroll="no">
	<head>
<title>상품 추가</title>
	</head>
	<div class="inputArea">
		<div class="filebox bs3-primary">
			<img src="http://placehold.it/200x200"><br> <label
				for="ex_file2">업로드</label> <br> <input type="file"
				id="ex_file2">
		</div>
	</div>

	<div>
		<progress value="0" max="100" id="uploader">0%</progress>
		<input type="file" value="upload" id="fileButton" />
	</div>

	<div class="inputArea">
		<label for="gdsName">상품명</label> <input type="text" id="gdsName"
			name="gdsName" />
	</div>

	<div class="inputArea">
		<label for="gdsPrice">상품가격</label> <input type="text" id="gdsPrice"
			name="gdsPrice" />
	</div>

	<div class="inputArea">
		<label for="gdsDes">상품소개</label>
		<textarea rows="5" cols="50" id="gdsDes" name="gdsDes"></textarea>
	</div>

	<div class="inputArea">
		<label for="gdsNum">일일 수량</label> <input type="text" id="gdsNum" />
	</div>

	<div class="inputArea">
		<button type="submit" id="register_Btn" class="btn btn-primary">등록</button>
	</div>

	<div id="loading">
		<img id="loading-image" src="assets/img/25.gif" alt="Loading..." />
	</div>

</th:block>

<script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js">
</script>

<script>
//Your web app's Firebase configuration
var firebaseConfig = {
	apiKey : "AIzaSyDcJDqLBjqwDetOcCt5LcYjr8k8EL7mMnk",
	authDomain : "blogapp-a9a56.firebaseapp.com",
	databaseURL : "https://blogapp-a9a56.firebaseio.com",
	projectId : "blogapp-a9a56",
	storageBucket : "blogapp-a9a56.appspot.com",
	messagingSenderId : "604610409810",
	appId : "1:604610409810:web:76decd7c19ac5f6b"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

//DOM요소 가져오기 - 개별적 변수 선언
// Get elements
var uploader = document.getElementById('uploader');
var fileButton = document.getElementById('fileButton');

// Listen for file selection - 파일이 선택되었을 때 알 수 있도록 해야함
fileButton.addEventListener('change', function(e){
	//
	function guid() {
  		function s4(){
    	return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  		}
  			return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
	}
	
	//파일이 업로드될때 이 함수 안에서 호출 할 것임
	
	// Get file - 파일을 가져오기 위해 타깃 요소에 있는 파일 객체에서 입력할 것
	var file = e.target.files[0];
	
	// Create a storage ref - 스토리지 참조 생성
	//firebase.storage().ref('folder_name/file_name');
	
	var storageRef = firebase.storage().ref('uploadTest/' + guid());
	
	// Upload file
	var task = storageRef.put(file);
	
	// Update progress bar
	task.on('state_changed',
		function progress(snapshot){
			var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
			uploader.value = percentage;
		},
		
		function error(err){
			
		},
		
		function complete(){
			
		}
	);
});		
</script>


</html>